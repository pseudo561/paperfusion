export type Language = 'ja' | 'en' | 'zh';

export const translations = {
  ja: {
    // Navigation
    home: 'ホーム',
    search: '検索',
    favorites: 'お気に入り',
    history: '履歴',
    recommendations: 'レコメンド',
    proposals: '研究提案',
    
    // Auth
    signIn: 'サインイン',
    signOut: 'サインアウト',
    pleaseSignIn: 'サインインしてください',
    
    // Common
    loading: '読み込み中...',
    error: 'エラーが発生しました',
    save: '保存',
    cancel: 'キャンセル',
    delete: '削除',
    edit: '編集',
    close: '閉じる',
    add: '追加',
    back: '戻る',
    all: 'すべて',
    
    // Language
    language: '言語',
    japanese: '日本語',
    english: 'English',
    chinese: '中文',
    
    // Home page
    welcomeTitle: 'へようこそ',
    homeDescription: 'AI駆動の論文検索・レコメンドプラットフォーム。最新の研究を発見し、新しいアイデアを創出しましょう。',
    greeting: 'こんにちは、',
    greetingSuffix: 'さん',
    featureSearchTitle: '論文検索',
    featureSearchDesc: 'arXivとSemantic Scholarから最新の論文を検索',
    featureRecommendTitle: 'AIレコメンド',
    featureRecommendDesc: 'お気に入りや評価から興味のある論文を推薦',
    featureFavoritesTitle: 'お気に入り管理',
    featureFavoritesDesc: '重要な論文をブックマークして整理',
    featureProposalsTitle: '研究テーマ提案',
    featureProposalsDesc: '複数の論文から新しい研究アイデアを生成',
    statsFavorites: 'お気に入り',
    statsFavoritesDesc: '保存された論文',
    statsHistory: '閲覧履歴',
    statsHistoryDesc: '最近の閲覧',
    statsAccuracy: '推薦精度',
    statsAccuracyHigh: '高',
    statsAccuracyPreparing: '準備中',
    statsAccuracyDesc: 'お気に入りを増やして精度向上',
    ctaTitle: '今すぐ始めましょう',
    ctaDescription: 'キーワードを入力して、関心のある論文を検索してください',
    ctaSearchButton: '論文を検索',
    
    // Search page
    searchTitle: '論文検索',
    searchDescription: 'arXivとSemantic Scholarから最新の研究論文を検索できます',
    searchCriteria: '検索条件',
    searchKeyword: 'キーワード',
    searchPlaceholder: '検索キーワードを入力',
    searchCategory: 'カテゴリ',
    searchCategoryPlaceholder: 'カテゴリを選択',
    searchSource: '検索元',
    both: '両方',
    arxiv: 'arXiv',
    semanticScholar: 'Semantic Scholar',
    searching: '検索中...',
    searchButton: '検索',
    searchResults: '検索結果',
    searchResultsCount: '件',
    noResults: '検索結果が見つかりませんでした',
    enterKeyword: 'キーワードを入力して検索を開始してください',
    authorUnknown: '著者不明',
    andOthers: 'ほか',
    citations: '引用数',
    openPdf: 'PDFを開く',
    errorKeywordRequired: '検索キーワードを入力してください',
    
    // Favorites page
    favoritesTitle: 'お気に入り',
    favoritesDescription: '保存した論文を管理できます',
    filterByTag: 'タグでフィルター',
    favoritesCount: '件の論文を保存しています',
    bulkGenerating: '一括生成中...',
    bulkGenerate: '全論文のタグを一括生成',
    noFavorites: 'まだお気に入りの論文がありません',
    noFavoritesDesc: '検索ページで論文を見つけてお気に入りに追加しましょう',
    noFavoritesWithTag: 'の論文がありません',
    tagPrefix: 'タグ「',
    tagSuffix: '」',
    addedOn: 'に追加',
    tags: 'タグ',
    aiGenerating: 'AI生成中...',
    aiGenerate: 'AIタグ生成',
    addTag: 'タグを追加',
    newTag: '新しいタグ',
    noTags: 'タグなし',
    paperNotFound: '論文情報が見つかりません',
    paperId: '論文ID',
    relatedSearching: '検索中...',
    relatedClose: '関連論文を閉じる',
    relatedSearch: '関連論文を検索',
    relatedError: '関連論文の取得に失敗しました',
    relatedNotFound: '関連論文が見つかりませんでした',
    citedBy: 'この論文を引用している論文',
    citedByCount: '件',
    references: 'この論文が引用している論文',
    referencesCount: '件',
    yearSuffix: '年',
    toastFavoriteRemoved: 'お気に入りから削除しました',
    toastRemoveFailed: '削除に失敗しました',
    toastTagsUpdated: 'タグを更新しました',
    toastTagsUpdateFailed: 'タグの更新に失敗しました',
    toastTagsGenerated: 'AIタグを生成しました',
    toastTagsGenerateFailed: 'タグの生成に失敗しました',
    toastBulkGenerated: '件の論文にタグを生成しました',
    toastBulkGenerateFailed: '件の論文でタグ生成に失敗しました',
    
    // History page
    historyTitle: '閲覧履歴',
    historyDescription: '過去に閲覧した論文の履歴を確認できます',
    filter: 'フィルター',
    selectCategory: 'カテゴリを選択',
    historyCount: '件の閲覧履歴',
    viewedOn: 'に閲覧',
    noHistory: '閲覧履歴がありません',
    noHistoryDesc: '論文を閲覧すると、ここに履歴が表示されます',
    
    // Recommendations page
    recommendationsTitle: 'AIレコメンド',
    recommendationsDescription: 'お気に入りや評価から興味のある論文を推薦',
    checking: '認証状態を確認しています...',
    loginRequired: 'ログインが必要です',
    loginDesc: 'AIレコメンド機能を使用するには、ログインしてお気に入り論文を追加してください。',
    backToHome: 'ホームに戻る',
    recommendationsLoading: '推薦論文を読み込んでいます...',
    errorOccurred: 'エラーが発生しました',
    errorMessage: '推薦論文の取得に失敗しました',
    noFavoritesForRecommend: 'お気に入り論文を追加すると、AIが関連する論文を推薦します。',
    toFavorites: 'お気に入りページへ',
    noRecommendations: '推薦論文がありません',
    noRecommendationsDesc: 'お気に入りに論文を追加すると、AIが関連する論文を自動的に推薦します。',
    toSearch: '論文を検索',
    loadMore: 'さらに表示',
    loadMoreCount: '件',
    
    // Proposals page
    proposalsTitle: '研究提案',
    proposalsDescription: 'お気に入りの論文から新しい研究アイデアを生成',
    researchProposals: '研究テーマ提案',
    researchProposalsDesc: '複数の論文から新しい研究アイデアを生成します',
    createNewProposal: '新しい提案を作成',
    noProposals: 'まだ研究提案がありません',
    noProposalsDesc: 'お気に入りの論文から新しい研究アイデアを生成しましょう',
    proposalContent: '提案内容',
    openProblems: '関連するオープンプロブレム',
    confirmDelete: 'この研究提案を削除しますか？',
    dialogTitle: '新しい研究提案を作成',
    selectPapersForProposal: '論文を選択（2〜5件）',
    selectPapersDesc: 'お気に入りから論文を選択してください',
    noFavoritesForProposal: 'お気に入りに論文がありません。まず論文を検索してお気に入りに追加してください。',
    generating: '生成中...',
    generateProposal: '提案を生成',
    generatedAt: '生成日時',
    basedOnPapers: '基にした論文',
    aboutThisFeature: 'この機能について',
    proposalFeatureDesc: 'お気に入りに保存した複数の論文を選択し、AIを使って新しい研究テーマを提案します。選択した論文の内容を分析し、それらを組み合わせた革新的な研究アイデアを生成します。',
    proposalGenerated: '研究提案を生成しました',
    proposalDeleted: '研究提案を削除しました',
    selectAtLeastOne: '少なくとも1つの論文を選択してください',
    
    // Paper Viewer
    viewerTitle: '論文閲覧',
    viewerBack: '戻る',
    viewerNoUrl: 'PDFのURLが指定されていません',
    viewerOpenInNewTab: '新しいタブで開く',
    viewerLoading: 'PDFを読み込んでいます...',
    viewerTroubleshoot: 'PDFが表示されない場合は、「新しいタブで開く」ボタンをクリックしてください',
  },
  en: {
    // Navigation
    home: 'Home',
    search: 'Search',
    favorites: 'Favorites',
    history: 'History',
    recommendations: 'Recommendations',
    proposals: 'Research Proposals',
    
    // Auth
    signIn: 'Sign in',
    signOut: 'Sign out',
    pleaseSignIn: 'Please sign in to continue',
    
    // Common
    loading: 'Loading...',
    error: 'An error occurred',
    save: 'Save',
    cancel: 'Cancel',
    delete: 'Delete',
    edit: 'Edit',
    close: 'Close',
    add: 'Add',
    back: 'Back',
    all: 'All',
    
    // Language
    language: 'Language',
    japanese: '日本語',
    english: 'English',
    chinese: '中文',
    
    // Home page
    welcomeTitle: 'Welcome to ',
    homeDescription: 'AI-driven paper search and recommendation platform. Discover the latest research and create new ideas.',
    greeting: 'Hello, ',
    greetingSuffix: '',
    featureSearchTitle: 'Paper Search',
    featureSearchDesc: 'Search latest papers from arXiv and Semantic Scholar',
    featureRecommendTitle: 'AI Recommendations',
    featureRecommendDesc: 'Get paper recommendations based on your favorites and ratings',
    featureFavoritesTitle: 'Favorites Management',
    featureFavoritesDesc: 'Bookmark and organize important papers',
    featureProposalsTitle: 'Research Proposals',
    featureProposalsDesc: 'Generate new research ideas from multiple papers',
    statsFavorites: 'Favorites',
    statsFavoritesDesc: 'Saved papers',
    statsHistory: 'History',
    statsHistoryDesc: 'Recent views',
    statsAccuracy: 'Recommendation Accuracy',
    statsAccuracyHigh: 'High',
    statsAccuracyPreparing: 'Preparing',
    statsAccuracyDesc: 'Add more favorites to improve accuracy',
    ctaTitle: 'Get Started Now',
    ctaDescription: 'Enter keywords to search for papers of interest',
    ctaSearchButton: 'Search Papers',
    
    // Search page
    searchTitle: 'Paper Search',
    searchDescription: 'Search latest research papers from arXiv and Semantic Scholar',
    searchCriteria: 'Search Criteria',
    searchKeyword: 'Keyword',
    searchPlaceholder: 'Enter search keywords',
    searchCategory: 'Category',
    searchCategoryPlaceholder: 'Select category',
    searchSource: 'Source',
    both: 'Both',
    arxiv: 'arXiv',
    semanticScholar: 'Semantic Scholar',
    searching: 'Searching...',
    searchButton: 'Search',
    searchResults: 'Search Results',
    searchResultsCount: ' items',
    noResults: 'No results found',
    enterKeyword: 'Enter keywords to start searching',
    authorUnknown: 'Unknown author',
    andOthers: 'et al.',
    citations: 'Citations',
    openPdf: 'Open PDF',
    errorKeywordRequired: 'Please enter search keywords',
    
    // Favorites page
    favoritesTitle: 'Favorites',
    favoritesDescription: 'Manage your saved papers',
    filterByTag: 'Filter by tag',
    favoritesCount: ' papers saved',
    bulkGenerating: 'Bulk generating...',
    bulkGenerate: 'Generate tags for all papers',
    noFavorites: 'No favorite papers yet',
    noFavoritesDesc: 'Find papers on the search page and add them to favorites',
    noFavoritesWithTag: ' papers',
    tagPrefix: 'Tag "',
    tagSuffix: '" has no',
    addedOn: 'Added on ',
    tags: 'Tags',
    aiGenerating: 'AI generating...',
    aiGenerate: 'Generate AI tags',
    addTag: 'Add tag',
    newTag: 'New tag',
    noTags: 'No tags',
    paperNotFound: 'Paper information not found',
    paperId: 'Paper ID',
    relatedSearching: 'Searching...',
    relatedClose: 'Close related papers',
    relatedSearch: 'Search related papers',
    relatedError: 'Failed to fetch related papers',
    relatedNotFound: 'No related papers found',
    citedBy: 'Papers citing this paper',
    citedByCount: ' items',
    references: 'Papers cited by this paper',
    referencesCount: ' items',
    yearSuffix: '',
    toastFavoriteRemoved: 'Removed from favorites',
    toastRemoveFailed: 'Failed to remove',
    toastTagsUpdated: 'Tags updated',
    toastTagsUpdateFailed: 'Failed to update tags',
    toastTagsGenerated: 'AI tags generated',
    toastTagsGenerateFailed: 'Failed to generate tags',
    toastBulkGenerated: ' papers tagged',
    toastBulkGenerateFailed: ' papers failed to tag',
    
    // History page
    historyTitle: 'Browsing History',
    historyDescription: 'View your paper browsing history',
    filter: 'Filter',
    selectCategory: 'Select category',
    historyCount: ' browsing history',
    viewedOn: 'Viewed on ',
    noHistory: 'No browsing history',
    noHistoryDesc: 'Your browsing history will appear here',
    
    // Recommendations page
    recommendationsTitle: 'AI Recommendations',
    recommendationsDescription: 'Get paper recommendations based on your favorites and ratings',
    checking: 'Checking authentication...',
    loginRequired: 'Login Required',
    loginDesc: 'Please login and add favorite papers to use AI recommendation feature.',
    backToHome: 'Back to Home',
    recommendationsLoading: 'Loading recommendations...',
    errorOccurred: 'An error occurred',
    errorMessage: 'Failed to fetch recommendations',
    noFavoritesForRecommend: 'Add favorite papers and AI will recommend related papers.',
    toFavorites: 'Go to Favorites',
    noRecommendations: 'No recommendations',
    noRecommendationsDesc: 'Add papers to favorites and AI will automatically recommend related papers.',
    toSearch: 'Search Papers',
    loadMore: 'Load More',
    loadMoreCount: ' items',
    
    // Proposals page
    proposalsTitle: 'Research Proposals',
    proposalsDescription: 'Generate new research ideas from your favorite papers',
    researchProposals: 'Research Proposals',
    researchProposalsDesc: 'Generate new research ideas from multiple papers',
    createNewProposal: 'Create New Proposal',
    noProposals: 'No research proposals yet',
    noProposalsDesc: 'Generate new research ideas from your favorite papers',
    proposalContent: 'Proposal Content',
    openProblems: 'Related Open Problems',
    confirmDelete: 'Delete this research proposal?',
    dialogTitle: 'Create New Research Proposal',
    selectPapersForProposal: 'Select papers (2-5)',
    selectPapersDesc: 'Select papers from your favorites',
    noFavoritesForProposal: 'No papers in favorites. Please search for papers and add them to favorites first.',
    generating: 'Generating...',
    generateProposal: 'Generate Proposal',
    generatedAt: 'Generated At',
    basedOnPapers: 'Based on Papers',
    aboutThisFeature: 'About This Feature',
    proposalFeatureDesc: 'Select multiple papers from your favorites and use AI to propose new research themes. Analyzes the content of selected papers and generates innovative research ideas by combining them.',
    proposalGenerated: 'Research proposal generated',
    proposalDeleted: 'Research proposal deleted',
    selectAtLeastOne: 'Please select at least one paper',
    
    // Paper Viewer
    viewerTitle: 'Paper Viewer',
    viewerBack: 'Back',
    viewerNoUrl: 'PDF URL not specified',
    viewerOpenInNewTab: 'Open in new tab',
    viewerLoading: 'Loading PDF...',
    viewerTroubleshoot: 'If PDF doesn\'t display, click \'Open in new tab\' button',
  },
  zh: {
    // Navigation
    home: '首页',
    search: '搜索',
    favorites: '收藏',
    history: '历史',
    recommendations: '推荐',
    proposals: '研究提案',
    
    // Auth
    signIn: '登录',
    signOut: '退出',
    pleaseSignIn: '请登录以继续',
    
    // Common
    loading: '加载中...',
    error: '发生错误',
    save: '保存',
    cancel: '取消',
    delete: '删除',
    edit: '编辑',
    close: '关闭',
    add: '添加',
    back: '返回',
    all: '全部',
    
    // Language
    language: '语言',
    japanese: '日本語',
    english: 'English',
    chinese: '中文',
    
    // Home page
    welcomeTitle: '欢迎来到',
    homeDescription: 'AI驱动的论文搜索和推荐平台。发现最新研究，创造新想法。',
    greeting: '你好，',
    greetingSuffix: '',
    featureSearchTitle: '论文搜索',
    featureSearchDesc: '从arXiv和Semantic Scholar搜索最新论文',
    featureRecommendTitle: 'AI推荐',
    featureRecommendDesc: '基于收藏和评分获取论文推荐',
    featureFavoritesTitle: '收藏管理',
    featureFavoritesDesc: '书签和整理重要论文',
    featureProposalsTitle: '研究提案',
    featureProposalsDesc: '从多篇论文生成新的研究想法',
    statsFavorites: '收藏',
    statsFavoritesDesc: '已保存论文',
    statsHistory: '历史',
    statsHistoryDesc: '最近浏览',
    statsAccuracy: '推荐准确度',
    statsAccuracyHigh: '高',
    statsAccuracyPreparing: '准备中',
    statsAccuracyDesc: '添加更多收藏以提高准确度',
    ctaTitle: '立即开始',
    ctaDescription: '输入关键词搜索感兴趣的论文',
    ctaSearchButton: '搜索论文',
    
    // Search page
    searchTitle: '论文搜索',
    searchDescription: '从arXiv和Semantic Scholar搜索最新研究论文',
    searchCriteria: '搜索条件',
    searchKeyword: '关键词',
    searchPlaceholder: '输入搜索关键词',
    searchCategory: '类别',
    searchCategoryPlaceholder: '选择类别',
    searchSource: '来源',
    both: '全部',
    arxiv: 'arXiv',
    semanticScholar: 'Semantic Scholar',
    searching: '搜索中...',
    searchButton: '搜索',
    searchResults: '搜索结果',
    searchResultsCount: '项',
    noResults: '未找到结果',
    enterKeyword: '输入关键词开始搜索',
    authorUnknown: '未知作者',
    andOthers: '等',
    citations: '引用',
    openPdf: '打开PDF',
    errorKeywordRequired: '请输入搜索关键词',
    
    // Favorites page
    favoritesTitle: '收藏',
    favoritesDescription: '管理您保存的论文',
    filterByTag: '按标签筛选',
    favoritesCount: '篇论文已保存',
    bulkGenerating: '批量生成中...',
    bulkGenerate: '为所有论文生成标签',
    noFavorites: '还没有收藏的论文',
    noFavoritesDesc: '在搜索页面找到论文并添加到收藏',
    noFavoritesWithTag: '篇论文',
    tagPrefix: '标签"',
    tagSuffix: '"没有',
    addedOn: '添加于',
    tags: '标签',
    aiGenerating: 'AI生成中...',
    aiGenerate: '生成AI标签',
    addTag: '添加标签',
    newTag: '新标签',
    noTags: '无标签',
    paperNotFound: '未找到论文信息',
    paperId: '论文ID',
    relatedSearching: '搜索中...',
    relatedClose: '关闭相关论文',
    relatedSearch: '搜索相关论文',
    relatedError: '获取相关论文失败',
    relatedNotFound: '未找到相关论文',
    citedBy: '引用此论文的论文',
    citedByCount: '项',
    references: '此论文引用的论文',
    referencesCount: '项',
    yearSuffix: '年',
    toastFavoriteRemoved: '已从收藏中移除',
    toastRemoveFailed: '移除失败',
    toastTagsUpdated: '标签已更新',
    toastTagsUpdateFailed: '更新标签失败',
    toastTagsGenerated: 'AI标签已生成',
    toastTagsGenerateFailed: '生成标签失败',
    toastBulkGenerated: '篇论文已标记',
    toastBulkGenerateFailed: '篇论文标记失败',
    
    // History page
    historyTitle: '浏览历史',
    historyDescription: '查看您的论文浏览历史',
    filter: '筛选',
    selectCategory: '选择类别',
    historyCount: '条浏览历史',
    viewedOn: '浏览于',
    noHistory: '无浏览历史',
    noHistoryDesc: '您的浏览历史将显示在这里',
    
    // Recommendations page
    recommendationsTitle: 'AI推荐',
    recommendationsDescription: '基于收藏和评分获取论文推荐',
    checking: '检查认证中...',
    loginRequired: '需要登录',
    loginDesc: '请登录并添加收藏论文以使用AI推荐功能。',
    backToHome: '返回首页',
    recommendationsLoading: '加载推荐中...',
    errorOccurred: '发生错误',
    errorMessage: '获取推荐失败',
    noFavoritesForRecommend: '添加收藏论文，AI将推荐相关论文。',
    toFavorites: '前往收藏',
    noRecommendations: '无推荐',
    noRecommendationsDesc: '添加论文到收藏，AI将自动推荐相关论文。',
    toSearch: '搜索论文',
    loadMore: '加载更多',
    loadMoreCount: '项',
    
    // Proposals page
    proposalsTitle: '研究提案',
    proposalsDescription: '从收藏的论文生成新的研究想法',
    researchProposals: '研究提案',
    researchProposalsDesc: '从多篇论文生成新的研究想法',
    createNewProposal: '创建新提案',
    noProposals: '还没有研究提案',
    noProposalsDesc: '从收藏的论文生成新的研究想法',
    proposalContent: '提案内容',
    openProblems: '相关开放问题',
    confirmDelete: '删除此研究提案？',
    dialogTitle: '创建新研究提案',
    selectPapersForProposal: '选择论文（2-5篇）',
    selectPapersDesc: '从收藏中选择论文',
    noFavoritesForProposal: '收藏中没有论文。请先搜索论文并添加到收藏。',
    generating: '生成中...',
    generateProposal: '生成提案',
    generatedAt: '生成时间',
    basedOnPapers: '基于论文',
    aboutThisFeature: '关于此功能',
    proposalFeatureDesc: '从收藏中选择多篇论文，使用AI提出新的研究主题。分析所选论文的内容，并通过组合它们生成创新的研究想法。',
    proposalGenerated: '研究提案已生成',
    proposalDeleted: '研究提案已删除',
    selectAtLeastOne: '请至少选择一篇论文',
    
    // Paper Viewer
    viewerTitle: '论文查看器',
    viewerBack: '返回',
    viewerNoUrl: '未指定PDF URL',
    viewerOpenInNewTab: '在新标签页中打开',
    viewerLoading: '加载PDF中...',
    viewerTroubleshoot: '如果PDF未显示，请点击“在新标签页中打开”按钮',
  },
};

export type TranslationKey = keyof typeof translations.ja;

const LANGUAGE_KEY = 'app-language';

export function getLanguage(): Language {
  const saved = localStorage.getItem(LANGUAGE_KEY);
  if (saved && (saved === 'ja' || saved === 'en' || saved === 'zh')) {
    return saved;
  }
  
  // Detect browser language
  const browserLang = navigator.language.toLowerCase();
  if (browserLang.startsWith('ja')) return 'ja';
  if (browserLang.startsWith('zh')) return 'zh';
  return 'en';
}

export function setLanguage(lang: Language) {
  localStorage.setItem(LANGUAGE_KEY, lang);
  window.location.reload();
}

export function t(key: TranslationKey, lang?: Language): string {
  const currentLang = lang || getLanguage();
  return translations[currentLang][key] || translations.en[key] || key;
}

export function getLanguageName(lang: Language): string {
  switch (lang) {
    case 'ja': return '日本語';
    case 'en': return 'English';
    case 'zh': return '中文';
  }
}

export function getLLMLanguageInstruction(lang: Language): string {
  switch (lang) {
    case 'ja': return '日本語で応答してください。';
    case 'en': return 'Please respond in English.';
    case 'zh': return '请用中文回答。';
  }
}
